<source>
  @type forward
  # port 24224 # this is default
  @label @raw
  tag mongo.airhost
</source>

<label @raw>
  # <filter>
  #   @type parser
  #   key_name messages
  #   <parse>
  #     @type json
  #   </parse>
  # </filter>

  # <filter>
    #   @type detect_exceptions3
    #   # remove_tag_prefix foo
    #   # message log
    #   languages ruby
    #   # multiline_flush_interval 0.1
    # </filter>

  <match>
    @type relabel
    @label @rails
  </match>
</label>

<label @rails>
  # <match **>
  #   @type file
  #   path /var/log/fluentd/fluent
  #   # time_slice_format %Y%m%d
  #   # time_slice_wait 10s
  #   # time_format %Y-%m-%dT%H:%M:%S.%L
  #   # time_key sent_at
  # </match>

  <match mongo.**>
    @type mongo
    database airhost
    collection fluentd
    capped
    capped_size 100M
    host 152.32.134.198
    port 27017
    user fluentd
    remove_tag_prefix mongo.
    replace_dot_in_key_with __dot__
    replace_dollar_in_key_with __dollar__
    password temp1234
    <buffer>
      flush_interval 1s
    </buffer>
  </match>
</label>
